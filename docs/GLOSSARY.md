# Glossary

A comprehensive guide to terminology, components, and concepts used in the Cardano Ledger Key Extraction Tool.

---

## Core Cryptographic Concepts

### **BIP39 (Bitcoin Improvement Proposal 39)**

A standardized method for generating deterministic wallets from a human-readable mnemonic phrase (recovery phrase). The mnemonic consists of 12, 15, 18, or 24 words selected from a predefined wordlist of 2048 words.

**Example:** `abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon about`

### **Mnemonic / Recovery Phrase / Seed Phrase**

A sequence of words (12-24) that encodes entropy used to derive all cryptographic keys in a hierarchical deterministic (HD) wallet. This is the ultimate backup - anyone with this phrase can recreate all wallet keys.

**⚠️ Security:** Never share, photograph, or store digitally. Write on paper and store securely offline.

### **Entropy**

Random data (128-256 bits) that forms the foundation of mnemonic generation. Higher entropy = more security. A 24-word mnemonic has 256 bits of entropy (2^256 possible combinations).

### **Master Key / Root Key**

The top-level private key derived from the mnemonic using key derivation algorithms (PBKDF2 + HMAC-SHA512 for Ledger). All other keys in the wallet are mathematically derived from this master key.

**Format:** 96-byte extended private key (64-byte key + 32-byte chain code)

### **Extended Key (xprv / xpub)**

A key format that includes both the actual cryptographic key material (64 bytes) and a chain code (32 bytes) used for deriving child keys in HD wallets.

- **xprv** = Extended Private Key (can derive child private keys)
- **xpub** = Extended Public Key (can derive child public keys only)

### **Chain Code**

A 32-byte value paired with a key to enable hierarchical key derivation. It acts as additional entropy when deriving child keys, ensuring that compromising one child key doesn't compromise siblings.

### **Key Derivation**

The mathematical process of creating child keys from a parent key using a derivation path. Uses HMAC-SHA512 with the parent key, chain code, and index number.

### **ed25519**

An elliptic curve digital signature algorithm used by Cardano. It's fast, secure, and produces 32-byte public keys and 64-byte signatures.

### **ed25519-bip32**

Cardano's hierarchical deterministic key derivation scheme for ed25519 keys. Extends standard ed25519 to support BIP32-style HD wallets with hardened derivation.

---

## Cardano-Specific Components

### **Shelley Era**

The second major phase of Cardano's development (launched July 2020), which introduced decentralization, staking, and delegation. The key formats and address types generated by this tool are Shelley-era compatible.

### **Stake Key / Staking Key**

A cryptographic key pair used to prove ownership of staked ADA and receive rewards. Derived from path `1852H/1815H/0H/2/0`.

**Files generated:**

- `stake.xprv` - Extended private key
- `stake.xpub` - Extended public key
- `stake.skey` - Cardano-cli signing key (JSON)
- `stake.vkey` - Cardano-cli verification key (JSON)
- `stake.addr` - Stake address (starts with `stake1`)

### **Payment Key**

A cryptographic key pair used to control funds. Derived from path `1852H/1815H/0H/0/0`.

**Files generated:**

- `payment.xprv` - Extended private key
- `payment.xpub` - Extended public key
- `payment.skey` - Cardano-cli signing key (JSON)
- `payment.vkey` - Cardano-cli verification key (JSON)
- `payment.addr` - Payment-only address (starts with `addr1v`)

### **Stake Pool**

A node on the Cardano network that processes transactions and produces blocks. Pool operators need both owner stake keys (for pledge) and reward account keys (for receiving operator rewards).

### **Pledge**

The amount of ADA a stake pool operator commits to their own pool. Higher pledge signals long-term commitment and can improve pool attractiveness. Requires control of stake keys.

### **Delegation**

The process of assigning your staking rights to a stake pool without transferring funds. Your ADA remains in your control; you just delegate the right to participate in consensus.

### **Base Address**

A Cardano address that combines both payment and staking credentials. Most commonly used address type in wallets.

**Format:** `addr1q...` (mainnet) or `addr_test1q...` (testnet)

**Components:**

- Payment credential (controls spending)
- Staking credential (controls delegation and rewards)

**Example:** `addr1qy2vzmtlgvjrhkq50rngh8d482zj3l20kyrc6kx4ffl3zfqayfawlf9hwv2fzuygt2km5v92kvf8e3s3mk7ynxw77cwqf7zhh2`

### **Stake Address**

An address used solely for receiving staking rewards. Cannot hold funds directly.

**Format:** `stake1u...` (mainnet) or `stake_test1u...` (testnet)

**Example:** `stake1uywjy7h05jmhx9y3wzy94td6xz4txynuccgam0zfn800v8qq33z29`

### **Payment Address**

A simpler address containing only payment credentials (no staking). Can receive funds but won't earn staking rewards.

**Format:** `addr1v...` (mainnet)

**Example:** `addr1vy2vzmtlgvjrhkq50rngh8d482zj3l20kyrc6kx4ffl3zfqcrdgvh`

### **Network Tag**

A byte prefix in addresses indicating the network:

- `1` = Mainnet
- `0` = Testnet

---

## HD Wallet Structure (CIP-1852)

### **Derivation Path**

A hierarchical notation describing how to derive a specific key from the master key. Uses slash-separated indices with `H` denoting hardened derivation.

**Format:** `m / purpose' / coin_type' / account' / role / index`

**Cardano Standard (CIP-1852):**

```bash
m / 1852' / 1815' / 0' / role / index
     │       │      │     │      │
     │       │      │     │      └─ Address index (0, 1, 2, ...)
     │       │      │     └─────── Role: 0=payment, 1=change, 2=stake
     │       │      └──────────── Account index (typically 0)
     │       └─────────────────── Coin type (1815 = Cardano/ADA)
     └─────────────────────────── Purpose (1852 = CIP-1852 standard)
```

**Example Paths:**

- **Payment key:** `m/1852H/1815H/0H/0/0` (first payment address)
- **Stake key:** `m/1852H/1815H/0H/2/0` (staking key)
- **Change key:** `m/1852H/1815H/0H/1/0` (first change address)

### **Hardened Derivation (marked with H or ')**

A more secure derivation mode that prevents child keys from revealing information about parent keys. Uses indices ≥ 2^31. Always used for the first three levels in Cardano paths.

**Security:** Even if a child private key is compromised, parent and sibling keys remain safe.

### **Non-Hardened Derivation**

Standard derivation allowing public key derivation without private keys. Used for the final two levels (role/index) to enable watch-only wallets.

---

## Tools & Components

### **cardano-cli**

The official command-line interface for Cardano node operations. Used for:

- Building and signing transactions
- Managing stake pools
- Converting key formats
- Generating addresses
- Querying blockchain state

**Current version:** 10.11.0.0+ (uses "latest" subcommand hierarchy)

**Key Commands:**

```bash
cardano-cli latest stake-address build --stake-verification-key-file stake.vkey --mainnet
cardano-cli latest address build --payment-verification-key-file payment.vkey --mainnet
```

### **cardano-address**

A standalone tool for address derivation and key manipulation. Handles:

- Mnemonic-to-key conversion
- HD key derivation
- Address generation
- Key format conversions

**Current version:** 4.0.1

**Key Operations:**

```bash
cardano-address key from-recovery-phrase Shelley < mnemonic.txt > root.prv
cardano-address key child 1852H/1815H/0H/2/0 < root.prv > stake.xprv
cardano-address key public --with-chain-code < stake.xprv > stake.xpub
```

### **bech32**

An encoding format used for Cardano keys and addresses. Includes error detection and human-readable prefixes.

**Common Prefixes:**

- `root_xsk` - Root extended signing key
- `acct_xsk` / `acct_xvk` - Account extended signing/verification key
- `addr_xsk` / `addr_xvk` - Address extended signing/verification key
- `stake1` - Stake address
- `addr1` - Payment/base address

**Tool Usage:**

```bash
echo "402b03cd..." | bech32 root_xsk > root.prv
```

### **Ledger Hardware Wallet**

A physical device that stores private keys in secure hardware (isolated from internet). Signs transactions without exposing keys to the computer.

**Key Extraction Mode:** A recovery scenario where you regenerate Ledger's keys from the mnemonic on an offline computer (for emergency access or pool operations).

---

## File Formats & Extensions

### **.prv / .xprv (Extended Private Key)**

Bech32-encoded extended private key containing:

- 64 bytes: Private key material
- 32 bytes: Chain code

**Security:** Contains secret material. Never share or commit to version control.

### **.pub / .xpub (Extended Public Key)**

Bech32-encoded extended public key containing:

- 32 bytes: Public key
- 32 bytes: Chain code

**Safe to share:** Can derive child public keys but cannot sign transactions.

### **.skey (Signing Key - cardano-cli format)**

JSON file containing private key in CBOR hex encoding.

**Format:**

```json
{
  "type": "PaymentExtendedSigningKeyShelley_ed25519_bip32",
  "description": "Payment Signing Key",
  "cborHex": "5880..."
}
```

**CBOR Prefixes:**

- `5880` - Extended key (128 bytes: 64-byte key + 32-byte chain code + metadata)
- `5820` - Non-extended key (64 bytes)

### **.vkey (Verification Key - cardano-cli format)**

JSON file containing public key in CBOR hex encoding.

**Format:**

```json
{
  "type": "PaymentVerificationKeyShelley_ed25519",
  "description": "Payment Verification Key",
  "cborHex": "5820..."
}
```

### **.addr (Address File)**

Plain text file containing a bech32-encoded Cardano address.

**Example:** `addr1qy2vzmtlgvjrhkq50rngh8d482zj3l20kyrc6kx4ffl3zfqayfawlf9hwv2fzuygt2km5v92kvf8e3s3mk7ynxw77cwqf7zhh2`

---

## Workflow Components

### **1. Mnemonic Input**

Starting point: 24-word recovery phrase from Ledger hardware wallet.

**Security:** Should only be entered on an **air-gapped, offline machine**.

### **2. Master Key Generation (`index.js`)**

JavaScript process that:

1. Converts mnemonic to 512-bit seed using PBKDF2 (2048 rounds)
2. Derives Ledger-compatible master key using ed25519-bip32
3. Outputs hex-encoded master key

**Output:** 192-character hex string (96 bytes)

### **3. Key Derivation (`convert.sh`)**

Bash script that:

1. Converts master key to bech32 root key
2. Derives stake keys (path: 1852H/1815H/0H/2/0)
3. Derives payment keys (path: 1852H/1815H/0H/0/0)
4. Generates public keys with chain codes
5. Converts to cardano-cli JSON format
6. Builds addresses
7. Verifies address correctness

**Output Directory Structure:**

```bash
output/
├── root.prv              # Root extended private key
├── stake.xprv            # Stake extended private key
├── stake.xpub            # Stake extended public key
├── stake.skey            # Stake signing key (JSON)
├── stake.vkey            # Stake verification key (JSON)
├── stake.addr            # Stake address
├── payment.xprv          # Payment extended private key
├── payment.xpub          # Payment extended public key
├── payment.skey          # Payment signing key (JSON)
├── payment.vkey          # Payment verification key (JSON)
├── payment.addr          # Payment address
├── base.addr             # Base address (payment + stake)
├── base.addr_candidate   # Verification candidate
└── generation-log.txt    # Process log
```

### **4. Address Verification**

Final step comparing `base.addr` with `base.addr_candidate` to ensure derivation correctness. Should also match the first address shown in Ledger-compatible wallets (AdaLite, Yoroi, Daedalus).

---

## Security Concepts

### **Air-Gapped Machine**

A computer physically isolated from all networks (no WiFi, Ethernet, Bluetooth). Used for handling sensitive cryptographic material.

**Best Practices:**

- Fresh OS installation
- Never connect to internet after key generation
- Disable all wireless hardware
- Transfer files via USB (one-way: out only)

### **Offline / Cold Storage**

Keeping private keys on devices never connected to the internet. Opposite of "hot wallets" which are internet-connected.

### **Key Sanitization**

The practice of clearing sensitive data from memory and logs after use. This tool should never log private keys to terminal or files.

### **Test Mnemonic**

The standard BIP39 test phrase: `abandon abandon abandon...` (12 or 24 words). Safe for testing derivation logic without risking real funds.

**Known Test Vector:**

- **Mnemonic:** `abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon abandon about`
- **Expected Address:** `addr1qy2vzmtlgvjrhkq50rngh8d482zj3l20kyrc6kx4ffl3zfqayfawlf9hwv2fzuygt2km5v92kvf8e3s3mk7ynxw77cwqf7zhh2`

---

## Common Abbreviations

| Term     | Full Name                            | Description                                          |
| -------- | ------------------------------------ | ---------------------------------------------------- |
| **HD**   | Hierarchical Deterministic           | Wallet structure where all keys derive from one seed |
| **BIP**  | Bitcoin Improvement Proposal         | Standardization documents (BIP39, BIP32, BIP44)      |
| **CIP**  | Cardano Improvement Proposal         | Cardano-specific standards (CIP-1852 for HD wallets) |
| **ADA**  | Cardano's native cryptocurrency      | Named after Ada Lovelace                             |
| **SPO**  | Stake Pool Operator                  | Individual/organization running a stake pool         |
| **CLI**  | Command-Line Interface               | Text-based tool (cardano-cli)                        |
| **CBOR** | Concise Binary Object Representation | Efficient binary data format used in Cardano         |
| **JSON** | JavaScript Object Notation           | Human-readable data format for key files             |
| **xprv** | Extended Private Key                 | Private key with chain code                          |
| **xpub** | Extended Public Key                  | Public key with chain code                           |
| **skey** | Signing Key                          | cardano-cli private key file                         |
| **vkey** | Verification Key                     | cardano-cli public key file                          |

---

## Platform & Architecture Terms

### **macOS**

Apple's Unix-based operating system.

**Architectures:**

- **x86_64** (Intel) - Older Macs
- **arm64** (Apple Silicon) - M1/M2/M3 Macs

### **Linux**

Open-source Unix-like operating systems (Ubuntu, Debian, Fedora, etc.).

**Architectures:**

- **x86_64** - Standard 64-bit Intel/AMD processors
- **aarch64** - 64-bit ARM processors (Raspberry Pi, cloud instances)

### **Windows (WSL2)**

Windows Subsystem for Linux version 2 - runs a real Linux kernel inside Windows for compatibility with Linux tools.

---

## References

- **CIP-1852:** Cardano HD Wallet Standard - <https://cips.cardano.org/cips/cip1852/>
- **BIP39:** Mnemonic Code Standard - <https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki>
- **BIP32:** HD Wallet Specification - <https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki>
- **ed25519-bip32:** Cardano's Key Derivation - <https://IntersectMBO.github.io/adrestia/static/Ed25519_BIP.pdf>
- **Adrestia Documentation:** <https://IntersectMBO.github.io/adrestia/>
- **Cardano Documentation:** <https://docs.cardano.org/>

---

## FAQ

**Q: What's the difference between extended and non-extended keys?**  
A: Extended keys include a chain code (32 bytes) for deriving child keys. Non-extended keys are just the raw cryptographic material (32-64 bytes).

**Q: Why does cardano-address 4.x require the `root_xsk` prefix?**  
A: Version 4.x enforces strict bech32 encoding with proper human-readable prefixes for key type safety.

**Q: Can I use these keys on testnet?**  
A: Yes, but change the network tag to `0` when building addresses with `--testnet-magic 1`.

**Q: What if my base.addr doesn't match base.addr_candidate?**  
A: This indicates a derivation error. Double-check tool versions and ensure cardano-address uses `--with-chain-code` for extended keys but `--without-chain-code` for address building.

**Q: Is it safe to share my .vkey files?**  
A: Yes, verification keys are public. However, they reveal your addresses, so consider privacy implications.

**Q: Why install tools to ./bin/ instead of system-wide?**  
A: Local installation prevents polluting system environment, ensures version consistency, and allows project portability without sudo permissions.
